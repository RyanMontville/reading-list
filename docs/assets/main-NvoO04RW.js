import"./style-BAurB_Qd.js";import{b as B,c as M}from"./booksDatabase-JlD-RXuw.js";const Y=new Date,x=Y.getFullYear();let r=[],c=[],C=[],E=[],T=[];const o=document.getElementById("filter-buttons"),a=document.getElementById("page-title"),w=document.querySelector("main");function $(){if(o){o.innerHTML="";const e=document.createElement("button"),t=document.createTextNode("Filter by Year");e.appendChild(t),e.setAttribute("type","button"),e.addEventListener("click",()=>{o.innerHTML="",C.forEach(d=>{let i=document.createElement("button");i.setAttribute("type","button");let p=document.createTextNode(`${d}`);i.appendChild(p),i.addEventListener("click",()=>N(d)),o.appendChild(i)})});const n=document.createElement("button"),l=document.createTextNode("Filter by Author");n.appendChild(l),n.setAttribute("type","button"),n.addEventListener("click",()=>{o.innerHTML="",E.forEach(d=>{let i=document.createElement("button");i.setAttribute("type","button");let p=document.createTextNode(d);i.appendChild(p),i.addEventListener("click",()=>F(d)),o.appendChild(i)})});const s=document.createElement("button"),u=document.createTextNode("Filter by Tag");s.appendChild(u),s.setAttribute("type","button"),s.addEventListener("click",()=>{o.innerHTML="",T.forEach(d=>{let i=document.createElement("button");i.setAttribute("type","button");let p=document.createTextNode(d);i.appendChild(p),i.addEventListener("click",()=>v(d)),o.appendChild(i)})}),o.appendChild(n),o.appendChild(s),o.appendChild(e)}}function y(){const e=document.createElement("button"),t=document.createElement("span");t.setAttribute("class","material-symbols-outlined");const n=document.createTextNode("filter_list");t.appendChild(n),e.appendChild(t);let l=document.createTextNode(" Filters");e.appendChild(l),e.setAttribute("id","more-filters"),e.setAttribute("type","button"),e.addEventListener("click",()=>{$()}),o&&o.appendChild(e)}function k(){const e=document.createElement("button");e.setAttribute("type","button");const t=document.createTextNode("Display All Books");e.appendChild(t),e.addEventListener("click",()=>{c=r,A(),b()}),o&&o.appendChild(e)}function A(){if(o){o.innerHTML="";const e=document.createElement("button");e.setAttribute("type","button");const t=document.createTextNode(`Filter for ${x} books`);e.addEventListener("click",()=>{N(x)}),e.appendChild(t),o.appendChild(e)}if(y(),a){a.innerHTML="";const e=document.createTextNode(`Displaying ${r.length} books`);a.appendChild(e)}}function N(e){o&&(o.innerHTML="",k(),y());const t=new Date(e,0,1).getFullYear();if(c=r.filter(n=>new Date(n.dateRead).getFullYear()===t),b(),a){const n=document.createTextNode(`Displaying ${c.length} books read in ${t}`);a.innerHTML="",a.appendChild(n)}}function F(e){if(o&&(o.innerHTML="",k(),y()),c=r.filter(t=>t.authors.includes(e)),b(),a){const t=document.createTextNode(`Displaying ${c.length} books by ${e}`);a.innerHTML="",a.appendChild(t)}}function v(e){if(o&&(o.innerHTML="",k(),y()),c=r.filter(t=>t.tags.includes(e)),b(),a){const t=document.createTextNode(`Displaying ${c.length} books matching ${e}`);a.innerHTML="",a.appendChild(t)}}function I(e){e.forEach(t=>{t.authors.forEach(n=>{E.includes(n)||E.push(n)})}),E.sort((t,n)=>{const l=t.split(" ").pop()??"",s=n.split(" ").pop()??"";return l.localeCompare(s)})}function R(e){e.forEach(t=>{t.tags.forEach(n=>{T.includes(n)||T.push(n)})}),T.sort()}function S(e){e.forEach(t=>{let n=new Date(t.dateRead).getFullYear();C.includes(n)||C.push(n)}),C.sort()}async function _(){try{await B.initializeData(),r=await B.getAllBooks(),c=r,R(r),I(r),S(r),A(),b(),console.log("Application loaded with books:",r)}catch(e){console.error("Critical error during application startup:",e)}}function b(){let e=document.getElementById("books-contianer");if(e&&e.remove(),c.length===0){let t=document.createElement("div"),n=document.createElement("p");n.textContent="No books found",t.appendChild(n)}else e=c.reduce((t,n)=>{const l=document.createElement("article"),s=document.createElement("img");s.setAttribute("src",n.cover),l.appendChild(s);const u=document.createElement("section"),d=document.createElement("h3");d.textContent=n.bookTitle,u.appendChild(d);const i=n.authors.reduce((h,f)=>{const m=document.createElement("a");m.addEventListener("click",()=>F(f));let g=document.createTextNode(f);return m.appendChild(g),h.appendChild(m),h},document.createElement("h4"));u.appendChild(i);const p=document.createElement("p"),L=new Date(n.dateRead);p.textContent=`Date Read: ${L.toLocaleString("default",{month:"long"})} ${L.getFullYear()}`,u.appendChild(p);const D=n.tags.reduce((h,f)=>{const m=document.createElement("li"),g=document.createTextNode(f);return m.addEventListener("click",()=>v(f)),m.appendChild(g),h.appendChild(m),h},document.createElement("ul"));u.appendChild(D);const H=M("View on StoryGraph",n.moreInfo,!0,"open_in_new");return u.appendChild(H),l.appendChild(u),t.appendChild(l),t},document.createElement("div")),e.setAttribute("id","books-contianer"),w.appendChild(e)}_();
