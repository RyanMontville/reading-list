import"./style-BPIH1s3W.js";import{b as g,c as L}from"./booksDatabase-YD73GoiF.js";const x=new Date,E=x.getFullYear();let l=[],c=[],m=[],f=[],h=[];const o=document.getElementById("filter-buttons"),a=document.getElementById("page-title"),N=document.querySelector("main");function F(){if(o){o.innerHTML="";const e=document.createElement("button"),t=document.createTextNode("Filter by Year");e.appendChild(t),e.setAttribute("type","button"),e.addEventListener("click",()=>{o.innerHTML="",m.forEach(s=>{let i=document.createElement("button");i.setAttribute("type","button");let u=document.createTextNode(`${s}`);i.appendChild(u),i.addEventListener("click",()=>T(s)),o.appendChild(i)})});const n=document.createElement("button"),r=document.createTextNode("Filter by Author");n.appendChild(r),n.setAttribute("type","button"),n.addEventListener("click",()=>{o.innerHTML="",f.forEach(s=>{let i=document.createElement("button");i.setAttribute("type","button");let u=document.createTextNode(s);i.appendChild(u),i.addEventListener("click",()=>B(s)),o.appendChild(i)})});const d=document.createElement("button"),A=document.createTextNode("Filter by Tag");d.appendChild(A),d.setAttribute("type","button"),d.addEventListener("click",()=>{o.innerHTML="",h.forEach(s=>{let i=document.createElement("button");i.setAttribute("type","button");let u=document.createTextNode(s);i.appendChild(u),i.addEventListener("click",()=>k(s)),o.appendChild(i)})}),o.appendChild(n),o.appendChild(d),o.appendChild(e)}}function b(){const e=document.createElement("button"),t=document.createElement("span");t.setAttribute("class","material-symbols-outlined");const n=document.createTextNode("filter_list");t.appendChild(n),e.appendChild(t);let r=document.createTextNode(" Filters");e.appendChild(r),e.setAttribute("id","more-filters"),e.setAttribute("type","button"),e.addEventListener("click",()=>{F()}),o&&o.appendChild(e)}function y(){const e=document.createElement("button");e.setAttribute("type","button");const t=document.createTextNode("Display All Books");e.appendChild(t),e.addEventListener("click",()=>{c=l,C(),p()}),o&&o.appendChild(e)}function C(){if(o){o.innerHTML="";const e=document.createElement("button");e.setAttribute("type","button");const t=document.createTextNode(`Filter for ${E} books`);e.addEventListener("click",()=>{T(E)}),e.appendChild(t),o.appendChild(e)}if(b(),a){a.innerHTML="";const e=document.createTextNode(`Displaying ${l.length} books`);a.appendChild(e)}}function T(e){o&&(o.innerHTML="",y(),b());const t=new Date(e,0,1).getFullYear();if(c=l.filter(n=>new Date(n.dateRead).getFullYear()===t),p(),a){const n=document.createTextNode(`Displaying ${c.length} books read in ${t}`);a.innerHTML="",a.appendChild(n)}}function B(e){if(o&&(o.innerHTML="",y(),b()),c=l.filter(t=>t.authors.includes(e)),p(),a){const t=document.createTextNode(`Displaying ${c.length} books by ${e}`);a.innerHTML="",a.appendChild(t)}}function k(e){if(o&&(o.innerHTML="",y(),b()),c=l.filter(t=>t.tags.includes(e)),p(),a){const t=document.createTextNode(`Displaying ${c.length} books matching ${e}`);a.innerHTML="",a.appendChild(t)}}function D(e){e.forEach(t=>{t.authors.forEach(n=>{f.includes(n)||f.push(n)})}),f.sort((t,n)=>{const r=t.split(" ").pop()??"",d=n.split(" ").pop()??"";return r.localeCompare(d)})}function v(e){e.forEach(t=>{t.tags.forEach(n=>{h.includes(n)||h.push(n)})}),h.sort()}function M(e){e.forEach(t=>{let n=new Date(t.dateRead).getFullYear();m.includes(n)||m.push(n)}),m.sort()}function p(){let e=document.getElementById("books-contianer");if(e&&e.remove(),c.length===0){let t=document.createElement("div"),n=document.createElement("p");n.textContent="No books found",t.appendChild(n)}else e=c.reduce((t,n)=>{const r=document.createElement("article");r.setAttribute("class","card hide-overflow");const d=L(n);return r.appendChild(d),t.appendChild(r),t},document.createElement("div")),e.setAttribute("id","books-contianer"),N.appendChild(e)}async function w(){try{await g.initializeData(),l=await g.getAllBooks(),c=l,v(l),D(l),M(l),C();const e=new URLSearchParams(window.location.search),t=e.get("year"),n=e.get("author"),r=e.get("tag");t?T(parseInt(t)):n?B(n):r?k(r):p(),console.log("Application loaded with books:",l)}catch(e){console.error("Critical error during application startup:",e)}}w();
