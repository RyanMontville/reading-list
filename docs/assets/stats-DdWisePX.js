import"./style-BAurB_Qd.js";import{b as A,a as N}from"./booksDatabase-DjHDF-ka.js";class u{constructor(n,e){this.color=n,this.tag=e}}let s=[],h=[],b=[],E=document.getElementById("cards-container");async function R(){try{await A.initializeData(),s=await A.getAllBooks(),x(s),k(s),M(s),D(),S()}catch(a){console.error("Critical error during application startup:",a)}}function k(a){a.forEach(n=>{n.authors.forEach(e=>{b.includes(e)||b.push(e)})}),b.sort((n,e)=>{const r=n.split(" ").pop()??"",t=e.split(" ").pop()??"";return r.localeCompare(t)})}function x(a){a.forEach(n=>{n.tags.forEach(e=>{})})}function M(a){a.forEach(n=>{let e=new Date(n.dateRead).getFullYear();h.includes(e)||h.push(e)}),h.sort()}function v(a){let n=[];a===0?n=s:n=s.filter(o=>o.dateRead.getFullYear()===a);const e=n.reduce((o,c)=>{const d={year:"numeric",month:"long"},l=c.dateRead.toLocaleDateString("en-US",d);return o[l]=(o[l]||0)+1,o},{});return Object.keys(e).map(o=>({itemKey:o,count:e[o]}))}function S(){const a=s.reduce((t,o)=>(t[o.mainTag]=(t[o.mainTag]||0)+1,t),{}),e=Object.keys(a).map(t=>({itemKey:t,count:a[t]}));console.log(e);const r=e.reduce((t,o)=>(t+=o.count,t),0);return console.log(r),e}function i(a,n){let e=s.filter(r=>r.tags.includes(a)).length;return n?e/s.length*100:e}function B(a){const n=document.createElement("article");n.setAttribute("class","card");const e=document.createElement("h2");e.textContent=a.cardTitle,n.appendChild(e);const r=a.pertencages.reduce((t,o)=>{const c=document.createElement("div");return c.setAttribute("class",o.color),c.style.width=`${i(o.tag,!0)}%`,t.appendChild(c),t},document.createElement("section"));return r.setAttribute("class","vs-bar"),n.appendChild(r),n}function T(a,n,e){const r=document.getElementById("frequency-div"),t=document.createElement("div");t.setAttribute("class","card"),t.setAttribute("id","frequency-div");const o=document.createElement("table"),c=document.createElement("thead"),d=document.createElement("tr"),l=document.createElement("th");l.setAttribute("style","width: 20%;"),a===0?l.textContent="Month Year":l.textContent="Month",d.appendChild(l);const p=document.createElement("th"),m=document.createTextNode("# Book Read");p.appendChild(m),d.appendChild(p),d.appendChild(p),c.appendChild(d),o.appendChild(c);const C=n.reduce((w,f)=>{let g=document.createElement("tr"),y=document.createElement("td");a===0?y.textContent=f.itemKey:y.textContent=f.itemKey.split(" ")[0],g.appendChild(y);let F=document.createElement("td"),K=document.createTextNode("â– ".repeat(f.count));return F.appendChild(K),g.appendChild(F),w.appendChild(g),w},document.createElement("tbody"));o.appendChild(C),t.appendChild(o),r?e.replaceChild(t,r):e.appendChild(t)}function D(){const a={cardTitle:`${i("Fiction",!1)} Fiction vs ${i("Nonfiction",!1)} Nonfiction`,pertencages:[new u("blue","Fiction"),new u("red","Nonfiction")]},n={cardTitle:`${i("Slow-paced",!1)} Slow-paced vs ${i("Medium-paced",!1)} Medium-paced vs ${i("Fast-paced",!1)} Fast-paced`,pertencages:[new u("red","Slow-paced"),new u("blue","Medium-paced"),new u("green","Fast-paced")]};let e=B(a);E.appendChild(e);let r=B(n);E.appendChild(r);const t=document.createElement("article");t.setAttribute("class","card");const o=document.createElement("label");o.setAttribute("for","year-select"),o.textContent="Filter year: ",t.appendChild(o);const c=N(h);c.setAttribute("id","year-select"),c.addEventListener("change",l=>{const m=l.target.value;let C=v(parseInt(m));T(parseInt(m),C,t)}),t.appendChild(c);let d=v(0);T(0,d,t),E.appendChild(t)}R();
